<div class="sidebar-sticky">
  <div class="sidebar-about">
    {% if site.logo %}
      <a class="no-hover" href="{{ '/' | relative_url }}" tabindex="-1">
        <img src="{% include_cached smart-url url=site.logo %}" class="avatar" alt="{{ site.short_title | default:site.title }}" width="120" height="120" loading="lazy" />
      </a>
    {% endif %}
    <a class="sidebar-title" href="{{ '/' | relative_url }}"><h2 class="h1">{{ site.short_title | default:site.title }}</h2></a>
    {% assign text = site.tagline | default:site.description %}
    {% if text %}
      <p class="{% if text.size > 100 %}fine{% endif %}">
        {{ text | markdownify | replace:'<p>','' | replace:'</p>','' }}
      </p>
    {% endif %}
  </div>

  <nav class="sidebar-nav heading" role="navigation">
    {% include body/nav.html %}
  </nav>

  {% assign author = site.data.authors.first[1] | default:site.author %}
  <div class="sidebar-social">
    {% include components/social.html author=author %}
  </div>

  <!-- 방문자 수 표시 -->
  <div style="margin: 1rem 0; font-size: 0.9rem; line-height: 1.4;">
    <strong id="visitor-stats">방문자 정보를 불러오는 중...</strong>
  </div>

  <script>
    const totalKey = 'yongkyoon.github.io/total';  // 총 방문자 키
    const todayKey = 'yongkyoon.github.io/' + new Date().toISOString().slice(0, 10);
    const localVisitedKey = 'visited-' + todayKey;

    if (!localStorage.getItem(localVisitedKey)) {
      fetch(`https://api.countapi.xyz/hit/${todayKey}`)
        .then(res => res.json())
        .then(data => {
          localStorage.setItem(localVisitedKey, 'true');
          updateToday(data.value);
        });
    } else {
      fetch(`https://api.countapi.xyz/get/${todayKey}`)
        .then(res => res.json())
        .then(data => {
          updateToday(data.value);
        });
    }

    fetch(`https://api.countapi.xyz/hit/${totalKey}`)
      .then(res => res.json())
      .then(data => {
        updateTotal(data.value);
      });

    function updateToday(val) {
      document.getElementById("visitor-stats").dataset.today = val;
      updateDisplay();
    }

    function updateTotal(val) {
      document.getElementById("visitor-stats").dataset.total = val;
      updateDisplay();
    }

    function updateDisplay() {
      const el = document.getElementById("visitor-stats");
      const today = el.dataset.today;
      const total = el.dataset.total;
      if (today && total) {
        el.innerText = `오늘 방문자: ${today} / 총 방문자: ${total}`;
      }
    }
  </script>
    
</div>